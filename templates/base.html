<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}여행맛집로그{% endblock %}</title>
    
    <!-- 부트스트랩 CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    
    <!-- 페이지별 추가 CSS -->
    <style>
        .profile-image-block img {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 50%;
        }
        .logout-btn {
            border: none;
            background: none;
            color: #0d6efd;
            cursor: pointer;
            padding: 0;
        }
        /* 로그인 폼 추가 스타일 */
        .login-card {
            border: none;
            border-radius: 10px;
        }
        .login-card .card-body {
            padding: 2rem;
        }
        /* 비로그인 사용자 네비게이션 스타일 */
        .guest-nav {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <div id="wrapper" class="container py-3">
    <header class="border-bottom pb-3 mb-3">
    <div class="d-flex justify-content-between align-items-center flex-wrap mb-2">
        <!-- 로고 -->
        <a href="/" class="text-dark text-decoration-none">
            <h1 class="fs-4 mb-0">여행맛집로그</h1>
        </a>

        {% block search %}
        <!-- 검색폼 -->
        <form method="get" action="{% url 'blog:post_search' %}" class="d-flex align-items-center" role="search">
            <div class="input-group" style="max-width: 300px;">
                <input
                    type="search"
                    class="form-control rounded-start"
                    placeholder="검색어를 입력하세요"
                    aria-label="검색"
                    name="q"
                    value="{{ q|default:'' }}"
                    style="border: 1px solid #ced4da;"
                />
                <button class="btn btn-outline-primary rounded-end" type="submit">
                    <i class="bi bi-search"></i>
                </button>
            </div>
        </form>
        {% endblock %}
    </div>

    {% block header_extra %}
    {% if user.is_authenticated %}
    <!-- 2줄: 환영 인사 + 프로필 수정 -->
    <div class="d-flex justify-content-end align-items-center gap-3 mb-2">
        <p class="mb-0"><strong>{{ user.profile.display_name }}</strong>님, 환영합니다!</p>
        <a href="{% url 'accounts:profile_edit' %}" class="btn btn-outline-secondary btn-sm">프로필 수정</a>
    </div>

    <!-- 3줄: 글쓰기 버튼 + 로그아웃 -->
    <div class="d-flex justify-content-end gap-2">
        <a href="{% url 'blog:post_write' %}" class="btn btn-primary btn-sm">글쓰기</a>

        <form method="post" action="{% url 'accounts:logout' %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline-danger btn-sm">로그아웃</button>
        </form>
    </div>
    {% endif %}
    {% endblock %}
</header>

        {% comment %} <!-- 사용자 내비게이션 -->
        {% block user_nav %}
        {% if not user.is_authenticated %}
        <nav class="guest-nav">
            <div class="text-center">
                <p class="mb-2 text-muted">로그인하여 더 많은 기능을 이용하세요</p>
                <div class="d-flex justify-content-center gap-2">
                    <a href="{% url 'accounts:login' %}" class="btn btn-primary btn-sm">로그인</a>
                    <a href="{% url 'accounts:register' %}" class="btn btn-outline-primary btn-sm">회원가입</a>
                </div>
            </div>
        </nav>
        {% endif %}
        {% endblock %} {% endcomment %}

        <!-- 메인 콘텐츠 -->
        <main>
            {% block content %}
            {% endblock %}
        </main>
    </div>

    <!-- 부트스트랩 JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>