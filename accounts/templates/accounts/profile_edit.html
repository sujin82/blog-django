{% extends 'base.html' %}


{% block content %}
    <h1>프로필 수정</h1>
    <form action="" method="post" enctype="multipart/form-data" novalidate>
        {% csrf_token %}
        {% load static %}
        
        <div class="form-section profile-section">
            <h3 class="section-title">프로필 수정</h3>
            
            <!-- 현재 이미지 미리보기 -->
            <div class="form-group">
                <div class="current-image">
                    {% if profile.upload_img %}
                        <img id="profile-preview" src="{{ profile.upload_img.url }}" alt="프로필 이미지" style="width: 150px; height: 150px; border-radius: 50%;">
                    {% else %}
                        <img id="profile-preview" src="{% static 'images/default-profile.png' %}" alt="기본 프로필 이미지" style="width: 150px; height: 150px; border-radius: 50%;">
                    {% endif %}
                </div>
            </div>
            
            <div class="form-group">
                <label class="field-label" for="{{ form.upload_img.id_for_label }}">
                    프로필 이미지
                </label>
                {{ form.upload_img }}
                
                <!-- 기본 이미지로 변경 버튼 -->
                <button type="button" id="default-image-btn" style="background: none; border: none; color: #007bff; cursor: pointer; text-decoration: underline; margin-left: 10px;">
                    기본 이미지로 변경
                </button>
            </div>
            
            <div class="form-group">
                <label class="field-label" for="{{ form.nickname.id_for_label }}">
                    닉네임
                </label>
                {{ form.nickname }}
            </div>
        </div>
        
        <!-- 숨겨진 필드 -->
        {{ form.use_default_image }}
        
        <!-- 버튼 영역 -->
        <div class="form-actions">
            <button type="submit" class="submit-btn">수정완료</button>
        </div>
    </form>

    <script>
        document.getElementById('default-image-btn').addEventListener('click', function() {
        // 미리보기를 기본 이미지로 변경
        document.getElementById('profile-preview').src = '{% static "images/default-profile.png" %}';
        
        // 기본 이미지 플래그 설정
        document.getElementById('id_use_default_image').value = 'on';
        
        // 파일 업로드 필드 초기화
        document.getElementById('id_upload_img').value = '';
    });
    </script>
{% endblock %}
